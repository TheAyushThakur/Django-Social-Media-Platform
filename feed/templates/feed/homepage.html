{% extends "base.html" %}
{% load thumbnail %}
{% block title %}Home Page{% endblock title %}

{% block body %}

<div class="p-5" style="padding-top:5px; padding-bottom:5px; padding-left:5px; padding-right:5px; ">
    <div class="bg-gray-900/50 pb-16 px">
        <div class="mx-auto max-w-4xl lg:px-1">
            
            <!-- Posts from Followed Users -->
            {% if followed_posts %}
            <div class="mx-auto max-w-2xl lg:mx-0" style="padding-top:10px; padding-bottom:10px;">
                <h2 class="text-2xl font-bold tracking-tight text-gray-800/70 sm:text-3xl">Posts from Followed Users</h2>
            </div>
            <div class="mx-auto mt-6 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-6 border-t border-gray-300 pt-10 sm:mt-10 sm:pt-12 lg:mx-0 lg:max-w-none" style="margin-top:5px">
                {% for post in followed_posts %}
                <!-- Article -->
                <article class="flex w-full flex-col items-start justify-between bg-gray-800/70 rounded-lg p-4 shadow-sm">
                    <div class="flex items-center gap-x-4 text-xs">
                        <span class="text-gray-50/70">{{ post.date|date:"F j, Y, g:i:a" }}</span>
                    </div>
                    <div class="group relative grow">
                        <p class="mt-3 text-lg font-semibold text-gray-50/80 break-words whitespace-normal">
                            {{ post.text}}
                        </p>
                    </div>  
                    <div class="flex justify-between item-centre">
                        <a class="text-indigo-300 hover:underline" href="{% url 'feed:detail' post.id %}">
                            See complete post...
                        </a>
                    </div>
                    <div class="my-5">
                        <a class="flex items-center" href="{% url 'profiles:detail' post.author.username %}">
                            {% thumbnail post.author.profile.image "373x373" crop="center" as im %}
                                <img class="mr-4 w-10 h-10 object-cover rounded-full hidden sm:block" src="{{ im.url }}" alt="avatar">
                            {% endthumbnail %}
                            <h1 class="text-gray-50 font-bold hover:underline">{{ post.author.username }}</h1>
                        </a>
                    </div>
                </article>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Posts from Non-Followed Users -->
            {% if non_followed_posts %}
            <div class="mx-auto max-w-2xl lg:mx-0" style="padding-top:30px; padding-bottom:10px;">
                <h2 class="text-2xl font-bold tracking-tight text-gray-800/70 sm:text-3xl">Discover More Posts</h2>
            </div>
            <div class="mx-auto mt-6 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-6 border-t border-gray-300 pt-10 sm:mt-10 sm:pt-12 lg:mx-0 lg:max-w-none" style="margin-top:5px">
                {% for post in non_followed_posts %}
                <!-- Article -->
                <article class="flex w-full flex-col items-start justify-between bg-gray-800/70 rounded-lg p-4 shadow-sm">
                    <div class="flex items-center gap-x-4 text-xs">
                        <span class="text-gray-50/70">{{ post.date|date:"F j, Y, g:i:a" }}</span>
                    </div>
                    <div class="group relative grow">
                        <p class="mt-3 text-lg font-semibold text-gray-50/80 break-words whitespace-normal">
                            {{ post.text}}
                        </p>
                    </div>  
                    <div class="flex justify-between item-centre">
                        <a class="text-indigo-300 hover:underline" href="{% url 'feed:detail' post.id %}">
                            See complete post...
                        </a>
                    </div>
                    <div class="my-5">
                        <a class="flex items-center" href="{% url 'profiles:detail' post.author.username %}">
                            {% thumbnail post.author.profile.image "373x373" crop="center" as im %}
                                <img class="mr-4 w-10 h-10 object-cover rounded-full hidden sm:block" src="{{ im.url }}" alt="avatar">
                            {% endthumbnail %}
                            <h1 class="text-gray-50 font-bold hover:underline">{{ post.author.username }}</h1>
                        </a>
                    </div>
                </article>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Fallback if no posts at all -->
            {% if not followed_posts and not non_followed_posts %}
            <div class="mx-auto max-w-2xl lg:mx-0" style="padding-top:10px; padding-bottom:10px;">
                <h2 class="text-2xl font-bold tracking-tight text-gray-800/70 sm:text-3xl">No Posts Available</h2>
                <p class="text-gray-50/70 mt-2">Be the first to create a post!</p>
            </div>
            {% endif %}

        </div>
    </div>
</div>
{% endblock body %}